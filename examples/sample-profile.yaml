# ============================================================================
# Sample OSCAL Profile - Security Baseline
#
# This profile demonstrates:
# - Importing controls from NIST SP 800-53 Rev 5
# - Selecting specific controls for a baseline
# - Setting organization-defined parameters
# - Adding organizational requirements to controls
#
# Use 'oscal-cli resolve-profile' to produce a resolved catalog.
# ============================================================================

---
profile:
  uuid: a1b2c3d4-e5f6-4a7b-8c9d-0e1f2a3b4c5d

  # ==========================================================================
  # METADATA: Document identification and provenance
  # ==========================================================================
  metadata:
    title: Sample Security Baseline Profile
    last-modified: "2024-01-06T12:00:00Z"
    version: 1.0.0
    oscal-version: 1.1.2

    # Roles define responsibilities
    roles:
      - id: profile-author
        title: Profile Author

    # Parties are organizations or individuals
    parties:
      - uuid: 11111111-2222-4333-8444-555555555555
        type: organization
        name: Example Organization

    # Link roles to parties
    responsible-parties:
      - role-id: profile-author
        party-uuids:
          - 11111111-2222-4333-8444-555555555555

    remarks: >-
      This is a sample profile demonstrating control selection
      from NIST SP 800-53 Rev 5.

  # ==========================================================================
  # IMPORT: Select controls from source catalog(s)
  # ==========================================================================
  imports:
    - href: https://raw.githubusercontent.com/usnistgov/oscal-content/main/nist.gov/SP800-53/rev5/json/NIST_SP-800-53_rev5_catalog.json
      include-controls:
        - with-ids:
            # Access Control (AC) family
            - ac-1   # Policy and Procedures
            - ac-2   # Account Management
            - ac-3   # Access Enforcement
            - ac-6   # Least Privilege
            - ac-7   # Unsuccessful Logon Attempts

            # Awareness and Training (AT) family
            - at-1
            - at-2

            # Audit and Accountability (AU) family
            - au-1
            - au-2   # Event Logging
            - au-3   # Content of Audit Records
            - au-6   # Audit Record Review

            # Assessment, Authorization, and Monitoring (CA) family
            - ca-1
            - ca-2
            - ca-7   # Continuous Monitoring

            # Configuration Management (CM) family
            - cm-1
            - cm-2   # Baseline Configuration
            - cm-6   # Configuration Settings
            - cm-7   # Least Functionality

            # Contingency Planning (CP) family
            - cp-1
            - cp-9   # System Backup

            # Identification and Authentication (IA) family
            - ia-1
            - ia-2   # User Identification and Authentication
            - ia-5   # Authenticator Management

            # Incident Response (IR) family
            - ir-1
            - ir-4   # Incident Handling
            - ir-6   # Incident Reporting

            # Maintenance (MA) family
            - ma-1

            # Media Protection (MP) family
            - mp-1

            # Physical and Environmental Protection (PE) family
            - pe-1

            # Planning (PL) family
            - pl-1
            - pl-2   # System Security Plan

            # Personnel Security (PS) family
            - ps-1

            # Risk Assessment (RA) family
            - ra-1
            - ra-3   # Risk Assessment
            - ra-5   # Vulnerability Monitoring and Scanning

            # System and Services Acquisition (SA) family
            - sa-1

            # System and Communications Protection (SC) family
            - sc-1
            - sc-7   # Boundary Protection
            - sc-8   # Transmission Confidentiality and Integrity
            - sc-13  # Cryptographic Protection

            # System and Information Integrity (SI) family
            - si-1
            - si-2   # Flaw Remediation
            - si-3   # Malicious Code Protection
            - si-4   # System Monitoring

            # Supply Chain Risk Management (SR) family
            - sr-1

  # ==========================================================================
  # MERGE: How to combine controls from imports
  # as-is: true preserves the source structure
  # ==========================================================================
  merge:
    as-is: true

  # ==========================================================================
  # MODIFY: Customize controls for this baseline
  # ==========================================================================
  modify:
    # Set organization-defined parameter values
    set-parameters:
      # AC-1: Who defines access control policy
      - param-id: ac-1_prm_1
        values:
          - Chief Information Security Officer (CISO)

      # AC-2: Types of accounts requiring management
      - param-id: ac-2_prm_1
        values:
          - privileged accounts
          - shared accounts
          - group accounts
          - temporary accounts
          - service accounts

      # AC-2: Attributes to track for accounts
      - param-id: ac-2_prm_2
        values:
          - access authorizations
          - role membership
          - access attributes

      # AC-7: Failed login attempt thresholds
      - param-id: ac-7_prm_1
        values:
          - "3"
      - param-id: ac-7_prm_2
        values:
          - 15 minutes

      # AU-2: Events to audit
      - param-id: au-2_prm_1
        values:
          - successful and unsuccessful logon attempts
          - privileged function executions
          - security-relevant configuration changes
          - access to audit logs

      # AU-6: Audit review frequency
      - param-id: au-6_prm_1
        values:
          - weekly

      # CA-7: Continuous monitoring frequency
      - param-id: ca-7_prm_1
        values:
          - monthly

      # IA-5: Authenticator change timeframe
      - param-id: ia-5_prm_1
        values:
          - within 24 hours of initial issuance

      # RA-5: Vulnerability scanning frequency
      - param-id: ra-5_prm_1
        values:
          - monthly or when significant changes occur

      # SI-2: Patch management timeframes
      - param-id: si-2_prm_1
        values:
          - within 30 days of release for critical patches
          - within 90 days for non-critical patches

    # Add organization-specific requirements to controls
    alters:
      # AC-1: Add annual review requirement
      - control-id: ac-1
        adds:
          - position: ending
            parts:
              - id: ac-1_org_req
                name: item
                props:
                  - name: label
                    value: Organization-Defined
                prose: >-
                  The organization shall review and update access control
                  policies annually or when significant changes to the
                  information system occur.

      # IA-2: Add MFA requirement
      - control-id: ia-2
        adds:
          - position: ending
            parts:
              - id: ia-2_org_req
                name: item
                prose: >-
                  Multi-factor authentication is required for all privileged
                  access and remote access to organizational systems.

  # ==========================================================================
  # BACK-MATTER: References and resources
  # ==========================================================================
  back-matter:
    resources:
      - uuid: aaaaaaaa-bbbb-4ccc-8ddd-eeeeeeeeeeee
        title: NIST SP 800-53 Rev 5
        citation:
          text: >-
            Joint Task Force. Security and Privacy Controls for Information
            Systems and Organizations. NIST Special Publication 800-53,
            Revision 5. September 2020.
        rlinks:
          - href: https://doi.org/10.6028/NIST.SP.800-53r5
