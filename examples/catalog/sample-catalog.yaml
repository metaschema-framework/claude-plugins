# ============================================================================
# Sample OSCAL Catalog - Custom Security Controls
#
# This catalog demonstrates:
# - Organizing controls into groups (families)
# - Defining controls with parameters and statements
# - Adding control enhancements
# - Including guidance and references
#
# Use as a template for creating custom control catalogs.
# ============================================================================

---
catalog:
  uuid: b5f2c3d4-e5f6-4a7b-8c9d-1a2b3c4d5e6f

  # ==========================================================================
  # METADATA: Catalog identification and provenance
  # ==========================================================================
  metadata:
    title: Sample Custom Security Control Catalog
    last-modified: "2024-01-06T12:00:00Z"
    version: 1.0.0
    oscal-version: 1.1.2

    # Roles define responsibilities
    roles:
      - id: catalog-author
        title: Catalog Author
      - id: control-owner
        title: Control Owner

    # Parties are organizations or individuals
    parties:
      - uuid: 22222222-3333-4444-8555-666666666666
        type: organization
        name: Example Security Team
        email-addresses:
          - security@example.org

    # Link roles to parties
    responsible-parties:
      - role-id: catalog-author
        party-uuids:
          - 22222222-3333-4444-8555-666666666666

    remarks: >-
      This is a sample catalog demonstrating OSCAL catalog structure.
      It includes example controls for access control and audit logging.

  # ==========================================================================
  # GROUPS: Organize controls into families
  # ==========================================================================
  groups:
    # --------------------------------------------------
    # Access Control Family
    # --------------------------------------------------
    - id: ac
      title: Access Control
      class: family

      # Controls within this group
      controls:
        # ============================================
        # AC-1: Access Control Policy
        # ============================================
        - id: ac-1
          class: policy
          title: Access Control Policy and Procedures

          # Parameters allow customization
          params:
            - id: ac-1_prm_1
              label: organization-defined personnel or roles
              guidelines:
                - prose: >-
                    Specify the personnel or roles responsible for
                    developing and maintaining access control policy.

            - id: ac-1_prm_2
              label: organization-defined frequency
              guidelines:
                - prose: Specify how often to review the policy (e.g., annually).
              # Constrain allowed values
              constraints:
                - description: At least annually
              select:
                how-many: one
                choice:
                  - annually
                  - semi-annually
                  - quarterly

          # Properties add metadata
          props:
            - name: label
              value: AC-1
            - name: sort-id
              value: ac-01.00.00

          # Links to related resources (reference back-matter by UUID)
          links:
            - href: "#bbbbbbbb-cccc-4ddd-8eee-ffffffffffff"
              rel: reference
              text: NIST SP 800-53

          # Control statement parts
          parts:
            - id: ac-1_smt
              name: statement
              parts:
                - id: ac-1_smt.a
                  name: item
                  props:
                    - name: label
                      value: a.
                  prose: >-
                    Develop, document, and disseminate to {{ insert: param, ac-1_prm_1 }}
                    an access control policy that addresses purpose, scope, roles,
                    responsibilities, and compliance.

                - id: ac-1_smt.b
                  name: item
                  props:
                    - name: label
                      value: b.
                  prose: >-
                    Review and update the access control policy {{ insert: param, ac-1_prm_2 }}.

            - id: ac-1_gdn
              name: guidance
              prose: >-
                Access control policy can be included as part of the general
                security policy or be represented by multiple policies. Procedures
                can be documented in system security plans or in one or more
                separate documents.

        # ============================================
        # AC-2: Account Management
        # ============================================
        - id: ac-2
          class: control
          title: Account Management

          params:
            - id: ac-2_prm_1
              label: organization-defined account types
              guidelines:
                - prose: >-
                    Specify account types requiring special management
                    (e.g., privileged, shared, service accounts).

            - id: ac-2_prm_2
              label: organization-defined time period
              guidelines:
                - prose: Specify the review frequency for accounts.

          props:
            - name: label
              value: AC-2
            - name: sort-id
              value: ac-02.00.00

          parts:
            - id: ac-2_smt
              name: statement
              parts:
                - id: ac-2_smt.a
                  name: item
                  props:
                    - name: label
                      value: a.
                  prose: >-
                    Define and document the types of accounts allowed and
                    specifically prohibited for use within the system.

                - id: ac-2_smt.b
                  name: item
                  props:
                    - name: label
                      value: b.
                  prose: >-
                    Assign account managers for {{ insert: param, ac-2_prm_1 }}.

                - id: ac-2_smt.c
                  name: item
                  props:
                    - name: label
                      value: c.
                  prose: >-
                    Review accounts for compliance {{ insert: param, ac-2_prm_2 }}.

            - id: ac-2_gdn
              name: guidance
              prose: >-
                Account management includes the identification of account types,
                establishing conditions for group membership, and assigning
                associated authorizations.

          # Control enhancements extend base controls
          controls:
            - id: ac-2.1
              class: enhancement
              title: Automated Account Management

              props:
                - name: label
                  value: AC-2(1)
                - name: sort-id
                  value: ac-02.01.00

              parts:
                - id: ac-2.1_smt
                  name: statement
                  prose: >-
                    Employ automated mechanisms to support the management
                    of system accounts.

                - id: ac-2.1_gdn
                  name: guidance
                  prose: >-
                    Automated account management reduces administrative overhead
                    and improves consistency in applying account policies.

    # --------------------------------------------------
    # Audit and Accountability Family
    # --------------------------------------------------
    - id: au
      title: Audit and Accountability
      class: family

      controls:
        # ============================================
        # AU-1: Audit Policy
        # ============================================
        - id: au-1
          class: policy
          title: Audit and Accountability Policy and Procedures

          params:
            - id: au-1_prm_1
              label: organization-defined personnel or roles

            - id: au-1_prm_2
              label: organization-defined frequency
              select:
                how-many: one
                choice:
                  - annually
                  - semi-annually

          props:
            - name: label
              value: AU-1
            - name: sort-id
              value: au-01.00.00

          parts:
            - id: au-1_smt
              name: statement
              parts:
                - id: au-1_smt.a
                  name: item
                  props:
                    - name: label
                      value: a.
                  prose: >-
                    Develop, document, and disseminate to {{ insert: param, au-1_prm_1 }}
                    an audit and accountability policy.

                - id: au-1_smt.b
                  name: item
                  props:
                    - name: label
                      value: b.
                  prose: >-
                    Review and update the policy {{ insert: param, au-1_prm_2 }}.

        # ============================================
        # AU-2: Event Logging
        # ============================================
        - id: au-2
          class: control
          title: Event Logging

          params:
            - id: au-2_prm_1
              label: organization-defined event types
              guidelines:
                - prose: >-
                    Specify event types to log (e.g., authentication events,
                    privilege escalation, data access).

          props:
            - name: label
              value: AU-2
            - name: sort-id
              value: au-02.00.00

          links:
            - href: "#bbbbbbbb-cccc-4ddd-8eee-ffffffffffff"
              rel: reference

          parts:
            - id: au-2_smt
              name: statement
              parts:
                - id: au-2_smt.a
                  name: item
                  props:
                    - name: label
                      value: a.
                  prose: >-
                    Identify the types of events that the system is capable of
                    logging in support of the audit function.

                - id: au-2_smt.b
                  name: item
                  props:
                    - name: label
                      value: b.
                  prose: >-
                    Coordinate the event logging function with other organizational
                    entities requiring audit-related information.

                - id: au-2_smt.c
                  name: item
                  props:
                    - name: label
                      value: c.
                  prose: >-
                    Specify {{ insert: param, au-2_prm_1 }} for logging within
                    the system.

            - id: au-2_gdn
              name: guidance
              prose: >-
                Event logging requirements can be derived from applicable laws,
                regulations, policies, and organizational needs. Organizations
                should consider what events are needed to support investigations.

  # ==========================================================================
  # BACK-MATTER: References and resources
  # ==========================================================================
  back-matter:
    resources:
      - uuid: bbbbbbbb-cccc-4ddd-8eee-ffffffffffff
        title: NIST SP 800-53 Rev 5
        citation:
          text: >-
            Joint Task Force. Security and Privacy Controls for Information
            Systems and Organizations. NIST Special Publication 800-53,
            Revision 5. September 2020.
        rlinks:
          - href: https://doi.org/10.6028/NIST.SP.800-53r5

      - uuid: cccccccc-dddd-4eee-8fff-111111111111
        title: NIST SP 800-53A Rev 5
        citation:
          text: >-
            NIST. Assessing Security and Privacy Controls in Information
            Systems and Organizations. NIST Special Publication 800-53A,
            Revision 5. January 2022.
        rlinks:
          - href: https://doi.org/10.6028/NIST.SP.800-53Ar5
